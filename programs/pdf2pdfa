#!/usr/bin/env bash

INPUT=$1
OUTPUT=$2

docker run --runtime=${LAUNDRY_DOCKER_RUNTIME:-runsc} --network=none --ipc=private --memory 1g --kernel-memory=100M --cap-drop=ALL --log-driver=syslog -i --rm laundry-programs \
       /bin/bash -c 'cat > /home/docconv/input.pdf; /opt/laundry/bin/gs -dPDFA -dBATCH -dNOPAUSE -sProcessColorModel=DeviceCMYK -sDEVICE=pdfwrite -sPDFACompatibilityPolicy=1 -sOutputFile="/home/docconv/output-pdfa.pdf" "/home/docconv/input.pdf" > conv.out 2>&1; cat /home/docconv/output-pdfa.pdf' < $INPUT > $OUTPUT
