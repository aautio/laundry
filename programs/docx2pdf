#!/usr/bin/env bash

set -e -u

TOOLBIN=$(dirname $0)
INPUT=$1
OUTPUT=$2
contname=conv.p$$.r$RANDOM.u$UID
docker run --network=none --ipc=private --memory 1g --kernel-memory=100M --cap-drop=ALL --log-driver=syslog -i -e docconv_suffix=docx --name $contname libreconv < $INPUT
docker cp $contname:/home/docconv/out/document.pdf $OUTPUT
docker rm $contname
