Test pdf/a conversion running under nsjail, using system gs for now
- apt-get install ghostscript pax-utils # pax-utils for lddtree
- bash build-scripts/nsjail.bash
- using some sample input pdf, run strace -f -eopen /usr/bin/gs -dPDFA -dBATCH -dNOPAUSE -sProcessColorModel=DeviceCMYK -sDEVICE=pdfwrite -sPDFACompatibilityPolicy=1 -sOutputFile=pdfa.pdf input.pdf
- grep -v ENOENT gs-strace.out | cut -d \" -f 2  | sort | uniq | egrep '^/(etc|lib|var|usr|bin)/' | while read fn; do test -f "$fn" && echo "$fn"; done > chroot-files
- echo /usr/bin/gs >> chroot-files
- lddtree -l /usr/bin/gs >> chroot-files
- tar -C / --dereference --files-from chroot-files -cf gs-chroot.tar
- mkdir gs-chroot
- tar -C gs-chroot -xf gs-chroot.tar
- mkdir gs-tmp
- ./build-data/src/nsjail-1.3/nsjail -B /dev/urandom -B $PWD/gs-tmp:/tmp  -Mo --chroot $PWD/gs-chroot  -- /usr/bin/gs -dPDFA -dBATCH -dNOPAUSE -sProcessColorModel=DeviceCMYK -sDEVICE=pdfwrite -sPDFACompatibilityPolicy=1 -sOutputFile=/tmp/pdfa.pdf /tmp/in.pdf
- (above does not work as root)
- find your outut file at gs-tmp/pdfa.pdf
